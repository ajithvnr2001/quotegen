(function(){"use strict";const M=(n,e)=>{if(e<=0)return n;const t=n.data,s=n.width,i=n.height,o=Math.min(Math.floor(e*2),10);if(o<1)return n;const f=new Uint8ClampedArray(t.length);for(let c=0;c<i;c++)for(let a=0;a<s;a++){let p=0,x=0,y=0,g=0,r=0;for(let d=-o;d<=o;d++){const h=a+d;if(h>=0&&h<s){const u=(c*s+h)*4;p+=t[u],x+=t[u+1],y+=t[u+2],g+=t[u+3],r++}}const l=(c*s+a)*4;r>0&&(f[l]=p/r,f[l+1]=x/r,f[l+2]=y/r,f[l+3]=g/r)}for(let c=0;c<i;c++)for(let a=0;a<s;a++){let p=0,x=0,y=0,g=0,r=0;for(let d=-o;d<=o;d++){const h=c+d;if(h>=0&&h<i){const u=(h*s+a)*4;p+=f[u],x+=f[u+1],y+=f[u+2],g+=f[u+3],r++}}const l=(c*s+a)*4;r>0&&(t[l]=p/r,t[l+1]=x/r,t[l+2]=y/r,t[l+3]=g/r)}return n},b=(n,e)=>{const t=n.data,s=Math.max(-.9,Math.min(.9,e)),i=259*(s*100+255)/(255*(259-s*100));for(let o=0;o<t.length;o+=16)t[o]=i*(t[o]-128)+128,t[o+1]=i*(t[o+1]-128)+128,t[o+2]=i*(t[o+2]-128)+128;return n},m=(n,e)=>{let t=n;return e.contrast!==0&&(t=b(t,e.contrast)),e.blur>0&&(t=M(t,e.blur)),t};self.onmessage=n=>{const{imageData:e,filters:t}=n.data;try{const s=m(e,t);self.postMessage({success:!0,imageData:s})}catch(s){self.postMessage({success:!1,error:s.message})}}})();
